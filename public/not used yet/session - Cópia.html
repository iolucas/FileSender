<!DOCTYPE html>
<html>
    
    <head>
        <meta charset="utf-8">
        <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport' />
        <link rel="stylesheet" href="style.css"/>
        <title>qeek.me - Instant Sharing</title>        
    </head>
    
    <body>
        <div id="focus">
            <img src="img/logo4.png"><br><br>
<!--            <img src="img/loading.gif" style="height:100px;width:100px;"><br><br>-->
            <div id="userChoose">
                <span>Enter a username:<br></span>
                <input id="userInput" type="text" placeholder="E.g. Lucas" maxlength="20"><button onclick="setUserAndStart();">OK</button>
            </div>
            <span id="focusMessage"></span>
        </div>
        
        <div id="alerts"></div>
        
        <header>
            <nav id="leftNav">
                <img id="logoIco" src="img/logo_ico.png">
<!--                <img id="hostIco" src="img/host_ico.png">-->
                <img id="hostIco">
            </nav>
            
            <nav id="rightNav">
<!--                <img src="img/copy_ico.png">-->
                <img id="trashIco" src="img/trash_ico.png" style="display: none" onclick="DeleteFiles();">
                <img id="msgIco" src="img/msg_ico.png">
                <img src="img/browse_ico.png" onclick="document.getElementById('files').click();">
                <img id="menu-ico" src="img/menu_ico2.png">
                <input type="file" id="files" multiple>
            </nav>
        </header>
        
        <section>
            <div id="msgPanel">
                <textarea id="displayMsg" readonly disabled></textarea>
                <button type="button" id="sendButton" onclick="sendText();">Send</button>
                <textarea id="inputArea" placeholder=""></textarea>
            </div>  
            <div id="main-menu">               
                <div id="about-menu" class="menu-item">About</div>            
            </div>
            <div id="about-section">
                <img src="img/logo4.png"><br><br>
                <div>
                    Qeek.me is a web application for transfer files and information with a direct connection between browsers. Just type the same address of this page in another browser to create a direct connection and share your things.
                </div><br>
                <a href="mailto: qeek@qeek.me">qeek@qeek.me</a>
                <br><br><br>
                <span id="about-button" onclick="hideAbout();">Ok</span>
                <br><br>       
            </div>
            
            <div class="pcDevice">
            
            
            </div>
            
            
            
            <table>
                <tr><td rowspan="3" class="icon"><img src="img/icon_file.png"></td><td colspan="2" class="fileName">My archive.txt</td></tr>
                <tr><td>Text Archive</td><td class="fileOwnerCol">Lucas</td></tr>
                <tr><td class="sizeCol">8 kb</td><td class="iconTxt">Click for download</td></tr>
            </table>
        </section>


        <script src="Wocket.js"></script>
        <script src="misc.js"></script>
        <script src="downloadManager.js"></script>
        <script src="fileManager.js"></script>
        
        <script src="IconManager.js"></script>
        <script src="rtcconn.js"></script>
        <script src="idb.filesystem.min.js"></script>
        <script src="main.js"></script>
        
        <script>
            
            //if(window.location.substr(0,5) != "https")
                //window.location = "https" + window.location.substr(5); 
            
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-60400657-1', 'auto');
            ga('send', 'pageview');
            
            var menuOpened = false;
            
            document.body.addEventListener("click", function() {
                if(menuOpened)
                    hideMenu();
            });
            
            document.getElementById("menu-ico").addEventListener("click", function(e) {
                if(!menuOpened) {
                    e.cancelBubble = true;  //cancel bubble to prevent body click event to happen due to event continues to propagate to parent elements
                    showMenu();  
                }
            });
            
            document.getElementById("about-menu").addEventListener("click", function() {
                showAbout();  
            });
            
            window.onload = function() {                
                var user = getCookie("username");   //check if a cookie for the username exists                
                if(user != "")  //if it does exists, 
                    start(user);    //starts the application with the username speficified
                else {    //if not,
                    document.getElementById("userChoose").style.display = "block";  //display the screen to insert a username
                    document.getElementById("userInput").focus();
                }
            };
            
            function setUserAndStart() {
                var textValue = document.getElementById("userInput").value;
                
                if(textValue == "")
                    return;
                
                document.getElementById("userChoose").style.display = "none";
                setCookie("username",textValue,360);
                
                start(textValue);
            }
            
            function start(user) {
                checkCompatibilityAndStart(window.location.pathname.substr(1), user);   //start the application with the room id and username
            }
            
            function showMenu() {
                document.getElementById("main-menu").style.display = "block";
                document.getElementById("menu-ico").style.opacity = "1";
                menuOpened = true;
            }
            
            function hideMenu() {
                document.getElementById("main-menu").style.display = "none";
                document.getElementById("menu-ico").style.opacity = "0.5";
                menuOpened = false;
            }
            
            function showAbout() {
                document.getElementById("about-section").style.display = "block";
            }
            
            function hideAbout() {
                document.getElementById("about-section").style.display = "none";
            }
            
        </script>
    </body>   
</html>